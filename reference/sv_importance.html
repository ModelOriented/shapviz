<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>SHAP Importance Plots — sv_importance • shapviz</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- dalexverse --><link href="../dalexverse.css" rel="stylesheet"><link href="../dalexverse-2.css" rel="stylesheet"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="SHAP Importance Plots — sv_importance"><meta property="og:description" content='This function provides two types of SHAP importance plots: a bar plot
and a beeswarm plot (sometimes called "SHAP summary plot").
The two types of plots can also be combined.'><meta property="og:image" content="/logo.png"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script></head><body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">shapviz</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy" class="external-link">DrWhy.AI</a>
           developed by the <a href="https://mi2.ai/" class="external-link">MI².AI</a> </span>
          <span class="version version-default">0.10.1</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/basic_use.html">Using 'shapviz'</a>
    </li>
    <li>
      <a href="../articles/geographic.html">Geographic Components</a>
    </li>
    <li>
      <a href="../articles/multiple_output.html">Multiple 'shapviz' objects</a>
    </li>
    <li>
      <a href="../articles/tidymodels.html">Tidymodels</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/shapviz/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>SHAP Importance Plots</h1>
    <small class="dont-index">Source: <a href="https://github.com/ModelOriented/shapviz/blob/main/R/sv_importance.R" class="external-link"><code>R/sv_importance.R</code></a></small>
    <div class="hidden name"><code>sv_importance.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function provides two types of SHAP importance plots: a bar plot
and a beeswarm plot (sometimes called "SHAP summary plot").
The two types of plots can also be combined.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sv_importance</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">sv_importance</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'shapviz'</span></span>
<span><span class="fu">sv_importance</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  kind <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bar"</span>, <span class="st">"beeswarm"</span>, <span class="st">"both"</span>, <span class="st">"no"</span><span class="op">)</span>,</span>
<span>  max_display <span class="op">=</span> <span class="fl">15L</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"#fca50a"</span>,</span>
<span>  bar_width <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  bee_width <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  bee_adjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  viridis_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"shapviz.viridis_args"</span><span class="op">)</span>,</span>
<span>  color_bar_title <span class="op">=</span> <span class="st">"Feature value"</span>,</span>
<span>  show_numbers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  format_fun <span class="op">=</span> <span class="va">format_max</span>,</span>
<span>  number_size <span class="op">=</span> <span class="fl">3.2</span>,</span>
<span>  sort_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mshapviz'</span></span>
<span><span class="fu">sv_importance</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  kind <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bar"</span>, <span class="st">"beeswarm"</span>, <span class="st">"both"</span>, <span class="st">"no"</span><span class="op">)</span>,</span>
<span>  max_display <span class="op">=</span> <span class="fl">15L</span>,</span>
<span>  fill <span class="op">=</span> <span class="st">"#fca50a"</span>,</span>
<span>  bar_width <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>,</span>
<span>  bar_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dodge"</span>, <span class="st">"stack"</span>, <span class="st">"facets"</span>, <span class="st">"separate"</span><span class="op">)</span>,</span>
<span>  bee_width <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  bee_adjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  viridis_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"shapviz.viridis_args"</span><span class="op">)</span>,</span>
<span>  color_bar_title <span class="op">=</span> <span class="st">"Feature value"</span>,</span>
<span>  show_numbers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  format_fun <span class="op">=</span> <span class="va">format_max</span>,</span>
<span>  number_size <span class="op">=</span> <span class="fl">3.2</span>,</span>
<span>  sort_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class "(m)shapviz".</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar()</a></code> (if <code>kind = "bar"</code>) or to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">ggplot2::geom_point()</a></code> otherwise. For instance, passing <code>alpha = 0.2</code> will produce
semi-transparent beeswarms, and setting <code>size = 3</code> will produce larger dots.</p></dd>


<dt id="arg-kind">kind<a class="anchor" aria-label="anchor" href="#arg-kind"></a></dt>
<dd><p>Should a "bar" plot (the default), a "beeswarm" plot, or "both" be shown?
Set to "no" in order to suppress plotting. In that case, the sorted
SHAP feature importances of all variables are returned.</p></dd>


<dt id="arg-max-display">max_display<a class="anchor" aria-label="anchor" href="#arg-max-display"></a></dt>
<dd><p>How many features should be plotted?
Set to <code>Inf</code> to show all features. Has no effect if <code>kind = "no"</code>.</p></dd>


<dt id="arg-fill">fill<a class="anchor" aria-label="anchor" href="#arg-fill"></a></dt>
<dd><p>Color used to fill the bars (only used if bars are shown).</p></dd>


<dt id="arg-bar-width">bar_width<a class="anchor" aria-label="anchor" href="#arg-bar-width"></a></dt>
<dd><p>Relative width of the bars (only used if bars are shown).</p></dd>


<dt id="arg-bee-width">bee_width<a class="anchor" aria-label="anchor" href="#arg-bee-width"></a></dt>
<dd><p>Relative width of the beeswarms.</p></dd>


<dt id="arg-bee-adjust">bee_adjust<a class="anchor" aria-label="anchor" href="#arg-bee-adjust"></a></dt>
<dd><p>Relative bandwidth adjustment factor used in
estimating the density of the beeswarms.</p></dd>


<dt id="arg-viridis-args">viridis_args<a class="anchor" aria-label="anchor" href="#arg-viridis-args"></a></dt>
<dd><p>List of viridis color scale arguments. The default points to the
global option <code>shapviz.viridis_args</code>, which corresponds to
<code>list(begin = 0.25, end = 0.85, option = "inferno")</code>. These values are passed to
<code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">ggplot2::scale_color_viridis_c()</a></code>. For example, to switch to standard viridis,
either change the default with <code>options(shapviz.viridis_args = list())</code> or set
<code>viridis_args = list()</code>.</p></dd>


<dt id="arg-color-bar-title">color_bar_title<a class="anchor" aria-label="anchor" href="#arg-color-bar-title"></a></dt>
<dd><p>Title of color bar of the beeswarm plot. Set to <code>NULL</code>
to hide the color bar altogether.</p></dd>


<dt id="arg-show-numbers">show_numbers<a class="anchor" aria-label="anchor" href="#arg-show-numbers"></a></dt>
<dd><p>Should SHAP feature importances be printed? Default is <code>FALSE</code>.</p></dd>


<dt id="arg-format-fun">format_fun<a class="anchor" aria-label="anchor" href="#arg-format-fun"></a></dt>
<dd><p>Function used to format SHAP feature importances
(only if <code>show_numbers = TRUE</code>). To change to scientific notation, use
<code>function(x) = prettyNum(x, scientific = TRUE)</code>.</p></dd>


<dt id="arg-number-size">number_size<a class="anchor" aria-label="anchor" href="#arg-number-size"></a></dt>
<dd><p>Text size of the numbers (if <code>show_numbers = TRUE</code>).</p></dd>


<dt id="arg-sort-features">sort_features<a class="anchor" aria-label="anchor" href="#arg-sort-features"></a></dt>
<dd><p>Should features be sorted or not? The default is <code>TRUE</code>.</p></dd>


<dt id="arg-bar-type">bar_type<a class="anchor" aria-label="anchor" href="#arg-bar-type"></a></dt>
<dd><p>For "mshapviz" objects with <code>kind = "bar"</code>: How should bars be
represented? The default is "dodge" for dodged bars. Other options are "stack",
"wrap", or "separate" (via "patchwork"). Note that "separate" is currently
the only option that supports <code>show_numbers = TRUE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A "ggplot" (or "patchwork") object representing an importance plot, or - if
<code>kind = "no"</code> - a named numeric vector of sorted SHAP feature importances
(or a matrix in case of an object of class "mshapviz").</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The bar plot shows SHAP feature importances, calculated as the average absolute SHAP
value per feature. The beeswarm plot displays SHAP values per feature, using min-max
scaled feature values on the color axis. Non-numeric features are transformed
to numeric by calling <code><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix()</a></code> first. For both types of plots, the features
are sorted in decreasing order of importance.</p>
    </div>
    <div id="methods-by-class-">
    <h2>Methods (by class)</h2>

<ul><li><p><code>sv_importance(default)</code>: Default method.</p></li>
<li><p><code>sv_importance(shapviz)</code>: SHAP importance plot for an object of class "shapviz".</p></li>
<li><p><code>sv_importance(mshapviz)</code>: SHAP importance plot for an object of class "mshapviz".</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="sv_interaction.html">sv_interaction</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">X_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dtrain</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html" class="external-link">xgb.DMatrix</a></span><span class="op">(</span><span class="va">X_train</span>, label <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, nthread <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html" class="external-link">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dtrain</span>, nrounds <span class="op">=</span> <span class="fl">10</span>, nthread <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="shapviz.html">shapviz</a></span><span class="op">(</span><span class="va">fit</span>, X_pred <span class="op">=</span> <span class="va">X_train</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sv_importance</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sv_importance-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">sv_importance</span><span class="op">(</span><span class="va">x</span>, kind <span class="op">=</span> <span class="st">"no"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Petal.Length  Sepal.Width  Petal.Width      Species </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.62123659   0.08254966   0.06248401   0.02103343 </span>
<span class="r-in"><span><span class="fu">sv_importance</span><span class="op">(</span><span class="va">x</span>, kind <span class="op">=</span> <span class="st">"beeswarm"</span>, show_numbers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sv_importance-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Mayer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>




  </body></html>

